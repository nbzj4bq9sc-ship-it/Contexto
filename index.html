<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Contexto FR</title>

<style>
body {
  background:#121212;
  color:#fff;
  font-family:system-ui;
  margin:0;
  padding:16px;
}

.app {
  max-width:480px;
  margin:auto;
  display:flex;
  flex-direction:column;
  gap:12px;
}

h1 {
  text-align:center;
  margin-bottom:4px;
}

input, button {
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:10px;
  border:none;
}

input {
  background:#1e1e1e;
  color:#fff;
}

button {
  background:#4caf50;
  color:#000;
  font-weight:bold;
  cursor:pointer;
}

button:disabled {
  opacity:.5;
  cursor:not-allowed;
}

.message {
  text-align:center;
  font-size:14px;
  opacity:.8;
}

ul {
  list-style:none;
  padding:0;
  margin:0;
  display:flex;
  flex-direction:column;
  gap:8px;
}

li {
  background:#1e1e1e;
  padding:12px;
  border-radius:8px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:500;
}

/* couleurs */
.good { background:#1b5e20; }
.medium { background:#ef6c00; }
.bad { background:#8e0000; }

.rank {
  opacity:.8;
  font-size:14px;
}
</style>
</head>

<body>
<div class="app">
  <h1>Contexto ðŸ‡«ðŸ‡·</h1>

  <input id="guess" placeholder="Entrez un motâ€¦" />
  <button id="submit">Valider</button>

  <div id="info" class="message"></div>

  <ul id="results"></ul>
</div>

<script>
// ---------------- DONNÃ‰ES ----------------
const semanticGroups = {
  emotions: ["amour","haine","joie","tristesse","peur","colÃ¨re"],
  nature: ["arbre","forÃªt","pluie","soleil","vent","mer"],
  human: ["homme","femme","enfant","personne","gens"],
  city: ["ville","route","immeuble","voiture","bruit"],
  mind: ["pensÃ©e","idÃ©e","esprit","cerveau","mÃ©moire"]
};

// ---------------- MOT DU JOUR ----------------
const today = new Date().toISOString().slice(0,10);
const secretWords = Object.values(semanticGroups).flat();
const secret = secretWords[
  today.split("-").join("") % secretWords.length
];

// ---------------- STORAGE ----------------
const STORAGE_KEY = "contexto_fr_" + today;
const PLAYED_KEY = "contexto_fr_played_" + today;

let guesses = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
let played = localStorage.getItem(PLAYED_KEY) === "true";
let found = guesses.some(g => g.score === 1000);

// ---------------- LOGIQUE ----------------
function getGroup(word) {
  for (let g in semanticGroups) {
    if (semanticGroups[g].includes(word)) return g;
  }
  return null;
}

function similarity(word) {
  if (word === secret) return 1000;

  const g1 = getGroup(word);
  const g2 = getGroup(secret);

  if (!g1 || !g2) return Math.floor(Math.random()*200)+1;
  if (g1 === g2) return Math.floor(Math.random()*200)+700;
  return Math.floor(Math.random()*300)+300;
}

function colorClass(score) {
  if (score >= 800) return "good";
  if (score >= 500) return "medium";
  return "bad";
}

// ---------------- INTERACTIONS ----------------
const input = document.getElementById("guess");
const button = document.getElementById("submit");
const info = document.getElementById("info");

if (played && !found) {
  input.disabled = true;
  button.disabled = true;
  info.textContent = "ðŸ˜Ž Tu as dÃ©jÃ  jouÃ© aujourdâ€™hui. Partage Ã  tes amis et reviens demain !";
}

button.onclick = () => {
  if (played || found) return;

  const word = input.value.toLowerCase().trim();
  if (!word) return;
  if (guesses.some(g => g.word === word)) return;

  const score = similarity(word);
  guesses.push({ word, score });
  guesses.sort((a,b)=>b.score-a.score);

  if (score === 1000) {
    found = true;
    played = true;
    localStorage.setItem(PLAYED_KEY, "true");
    info.textContent = "ðŸŽ‰ Bravo ! Mot du jour trouvÃ©.";
    input.disabled = true;
    button.disabled = true;
  }

  localStorage.setItem(STORAGE_KEY, JSON.stringify(guesses));
  input.value = "";
  render();
};

// ---------------- RENDER ----------------
function render() {
  const ul = document.getElementById("results");
  ul.innerHTML = "";

  guesses.forEach((g,i)=>{
    const li = document.createElement("li");
    li.className = colorClass(g.score);
    li.innerHTML = `
      <span>${g.word}</span>
      <span class="rank">#${i+1} â€¢ ${g.score}</span>
    `;
    ul.appendChild(li);
  });
}

render();
</script>
</body>
</html>
